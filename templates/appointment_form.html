{% extends "base.html" %}

{% block content %}
<h2>{% if appointment %}Редактирование{% else %}Новый приём{% endif %}</h2>

<form method="POST">
    <div>
        <label>Пациент:</label>
        <select name="patient_id" required>
            <option value="">-- Выберите пациента --</option>
            {% for patient in patients %}
                <option value="{{ patient.id }}"
                    {% if appointment and appointment.patient_name == (patient.first_name + ' ' + patient.last_name) %}selected{% endif %}>
                    {{ patient.first_name }} {{ patient.last_name }}
                </option>
            {% endfor %}
        </select>
    </div>

    <div>
        <label>Врач:</label>
        <select name="doctor_id" required>
            <option value="">-- Выберите врача --</option>
            {% for doctor in doctors %}
                <option value="{{ doctor.id }}"
                    {% if appointment and appointment.doctor_name == (doctor.first_name + ' ' + doctor.last_name) %}selected{% endif %}>
                    {{ doctor.first_name }} {{ doctor.last_name }}
                </option>
            {% endfor %}
        </select>
    </div>

    <div>
        <label>Дата и время:</label>
        <input type="datetime-local" name="date"
               value="{{ appointment.date.strftime('%Y-%m-%dT%H:%M') if appointment else '' }}" required>
    </div>

    <div>
        <label>Примечания:</label>
        <textarea name="notes">{{ appointment.notes if appointment else '' }}</textarea>
    </div>

    <button type="submit" class="btn btn-primary">Сохранить</button>
</form>
{% endblock %}
